<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>주문 내역</title>
</head>
<body>
<div class="container">
    <h2>나의 주문 내역</h2>

    <table border="1">
        <thead>
        <tr>
            <th>주문번호</th>
            <th>주문 상품</th>
            <th>주문 시간</th>
            <th>주문 상태</th>
            <th>작업</th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${#lists.isEmpty(orders)}">
            <td colspan="5">주문 내역이 없습니다.</td>
        </tr>

        <tr th:each="order : ${orders}">
            <td th:text="${order.id}">1</td>
            <td>
                <div th:each="orderItem : ${order.orderItems}">
                    <span th:text="${orderItem.item.name}">상품명</span> / 
                    <span th:text="${orderItem.count} + '개'">수량</span>
                </div>
            </td>
            <td th:text="${#temporals.format(order.orderDateTime, 'yyyy-MM-dd HH:mm')}">2023-10-27</td>
			<td>
				<a th:href="@{/orders/{id}(id=${order.id})}">상세보기</a>
			</td>
            <td th:text="${order.status}">ORDER</td>
            <td>
                <form th:if="${order.status.name() == 'ORDER'}" 
                      th:action="@{/orders/{id}/cancel(id=${order.id})}" method="post">
                    <button type="submit" onclick="return confirm('정말 취소하시겠습니까?')">주문취소</button>
                </form>
                <span th:if="${order.status.name() == 'CANCEL'}">취소완료</span>
            </td>
        </tr>
        </tbody>
    </table>

    <div style="margin-top: 20px;">
        <button th:onclick="|location.href='@{/}'|">홈으로 이동</button>
    </div>
</div>
</body>
</html>