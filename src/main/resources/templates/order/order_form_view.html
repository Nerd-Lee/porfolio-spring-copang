<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>주문서 작성</title>
</head>
<body>
<div class="container">
    <h2>주문 / 결제</h2>
    
    <form th:action="@{/order/form/process}" th:object="${orderForm}" method="post">
		<fieldset>
		    <legend>주문 상품 정보</legend>
		    <table border="1" style="width: 100%">
		        <tr>
					<th>상품이미지</th>
		            <th>상품명</th>
		            <th>수량</th>
		            <th>가격</th>
		            <th>합계</th>
		        </tr>
		        <tr th:each="item, stat : ${orderForm.orderItems}">
		            <input type="hidden" th:name="|orderItems[${stat.index}].itemId|" th:value="${item.itemId}">
		            <input type="hidden" th:name="|orderItems[${stat.index}].count|" th:value="${item.count}">
		            
					<td>
						<img th:src="${item.imageUrl}" style="width:50px;">
					</td>
		            <td th:text="${item.itemName}"></td>
		            <td th:text="${item.count} + '개'"></td>
		            <td th:text="${item.itemPrice} + '원'"></td>
		            <td th:text="${item.itemPrice * item.count} + '원'"></td>
		        </tr>
		    </table>
		    <hr>
		    <h3>최종 결제 금액: <span th:text="${orderForm.totalPrice}"></span>원</h3>
		</fieldset>

        <br>

        <fieldset>
            <legend>배송지 정보</legend>
            <div>
                <label>받는 사람</label>
                <input type="text" th:field="*{receiverName}" required>
            </div>
            <div>
                <label>배송 주소</label>
                <input type="text" th:field="*{address}" placeholder="주소를 입력하세요" required>
            </div>
            <div>
                <label>연락처</label>
                <input type="text" th:field="*{phoneNumber}" placeholder="010-0000-0000" required>
            </div>
        </fieldset>

        <div style="margin-top: 20px;">
            <button type="submit">결제하기 (주문 완료)</button>
            <button type="button" onclick="history.back()">취소</button>
        </div>
    </form>
</div>
</body>
<script th:inline="javascript">
		/*<![CDATA[*/
		var errorMessage = [[${errorMessage}]];
		if (errorMessage) {
			alert(errorMessage);
		}
		    /*]]>*/
	</script>
</html>