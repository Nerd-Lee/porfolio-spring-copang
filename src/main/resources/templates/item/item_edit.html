<!--
<div class="container">
    <h2>상품 수정</h2>
    <form th:action th:object="${item}" method="post">
        <div class="mb-3">
            <label for="name">상품명</label>
            <input type="text" th:field="*{name}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="price">가격</label>
            <input type="number" th:field="*{price}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="stockQuantity">재고수량</label>
            <input type="number" th:field="*{stockQuantity}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="imageUrl">이미지 URL</label>
            <input type="text" th:field="*{imageUrl}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="description">상세 설명</label>
            <textarea th:field="*{description}" class="form-control" rows="5"></textarea>
        </div>

		<div class="d-flex justify-content-between">
			<div>
				<button type="submit" class="btn btn-primary">수정 완료</button>
				<button type="button" class="btn btn-secondary"
						th:onclick="|location.href='@{/items/{id}(id=${item.id})}'|">취소</button>
			</div>
					
			<div>
				<button type="button" class="btn btn-danger" th:onclick="deleteItem()">상품 삭제</button>
			</div>
		</div>
    </form>
</div>

<form id="deleteForm" th:action="@{/items/{id}/delete(id=${item.id})}" method="post" style="display:none;"></form>

<script>
    function deleteItem() {
        if (confirm("정말 이 상품을 삭제하시겠습니까? 삭제된 데이터는 복구할 수 없습니다.")) {
            document.getElementById('deleteForm').submit();
        }
    }
</script>
-->

<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #f8f9fa; font-family: 'Pretendard', sans-serif; }
        .container { max-width: 650px; margin-top: 60px; margin-bottom: 60px; }
        
        .form-wrapper {
            background: #fff;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.05);
            border: 1px solid #eee;
        }

        h2 { font-weight: 800; color: #333; margin-bottom: 30px; letter-spacing: -1px; }
        
        .form-label { font-weight: 600; color: #555; font-size: 14px; margin-bottom: 8px; }
        .form-control {
            border-radius: 6px;
            padding: 12px;
            border: 1px solid #ddd;
            transition: all 0.2s;
        }
        .form-control:focus {
            border-color: #0073e6;
            box-shadow: 0 0 0 3px rgba(0, 115, 230, 0.1);
        }

        /* 이미지 미리보기 박스 */
        .img-preview-box {
            width: 100%;
            height: 200px;
            background: #f1f3f5;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            overflow: hidden;
            border: 2px dashed #dee2e6;
        }
        .img-preview-box img { width: 100%; height: 100%; object-fit: contain; }

        .btn-update { background: #0073e6; border: none; padding: 12px 25px; font-weight: bold; color: white; border-radius: 6px; }
        .btn-update:hover { background: #005bb5; }
        .btn-cancel { background: #f1f3f5; border: none; color: #495057; padding: 12px 25px; font-weight: bold; border-radius: 6px; }
        .btn-cancel:hover { background: #e9ecef; }
        .btn-delete { background: #fff; border: 1px solid #dc3545; color: #dc3545; padding: 10px 20px; font-weight: bold; border-radius: 6px; font-size: 14px; }
        .btn-delete:hover { background: #dc3545; color: #fff; }
        
        hr { border-top: 1px solid #eee; margin: 30px 0; }
    </style>
</head>
<body>

<div class="container">
    <div class="form-wrapper">
        <div class="text-center mb-4">
            <h2>✏️ 상품 정보 수정</h2>
            <p class="text-muted small">수정된 내용은 즉시 상품 상세페이지에 반영됩니다.</p>
        </div>

        <form th:action th:object="${item}" method="post">
            <div class="img-preview-box" id="imgPreview">
                <img th:if="*{imageUrl != null and imageUrl != ''}" th:src="*{imageUrl}" id="previewImg">
                <span th:unless="*{imageUrl != null and imageUrl != ''}">등록된 이미지가 없습니다.</span>
            </div>

            <div class="mb-3">
                <label for="imageUrl" class="form-label">이미지 URL</label>
                <div class="input-group">
                    <span class="input-group-text bg-light"><i class="fas fa-image"></i></span>
                    <input type="text" id="imageUrl" th:field="*{imageUrl}" class="form-control" 
                           placeholder="이미지 주소를 입력하세요" oninput="updatePreview(this.value)">
                </div>
            </div>

            <div class="mb-3">
                <label for="name" class="form-label">상품명</label>
                <input type="text" id="name" th:field="*{name}" class="form-control">
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="price" class="form-label">가격 (원)</label>
                    <div class="input-group">
                        <input type="number" id="price" th:field="*{price}" class="form-control">
                        <span class="input-group-text">원</span>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="stockQuantity" class="form-label">재고 수량</label>
                    <div class="input-group">
                        <input type="number" id="stockQuantity" th:field="*{stockQuantity}" class="form-control">
                        <span class="input-group-text">개</span>
                    </div>
                </div>
            </div>

            <div class="mb-3">
                <label for="description" class="form-label">상세 설명</label>
                <textarea id="description" th:field="*{description}" class="form-control" rows="5"></textarea>
            </div>

            <hr>

            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex gap-2">
                    <button type="submit" class="btn-update">수정 완료</button>
                    <button type="button" class="btn-cancel" 
                            th:onclick="|location.href='@{/items/{id}(id=${item.id})}'|">취소</button>
                </div>
                
                <div>
                    <button type="button" class="btn-delete" th:onclick="deleteItem()">
                        <i class="far fa-trash-alt"></i> 상품 삭제
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<form id="deleteForm" th:action="@{/items/{id}/delete(id=${item.id})}" method="post" style="display:none;"></form>

<script>
    // 이미지 URL 입력 시 실시간 미리보기
    function updatePreview(url) {
        const previewBox = document.getElementById('imgPreview');
        if (url.trim() !== "") {
            previewBox.innerHTML = `<img src="${url}" onerror="imgError(this)">`;
        } else {
            previewBox.innerHTML = `<span>이미지 주소를 입력해 주세요.</span>`;
        }
    }

    function imgError(image) {
        image.onerror = null;
        image.parentElement.innerHTML = `<span class="text-danger">잘못된 이미지 주소입니다.</span>`;
    }

    // 삭제 확인 팝업
    function deleteItem() {
        if (confirm("정말 이 상품을 삭제하시겠습니까?\n삭제된 데이터는 절대 복구할 수 없습니다.")) {
            document.getElementById('deleteForm').submit();
        }
    }
</script>

</body>
</html>